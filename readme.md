# 电梯调度

###### 操作系统第一次作业

### Author: 1753127 何立仁



## 项目介绍

### 1. 背景

- 本项目为某栋共20层，拥有五部互联电梯的楼编写电梯调度算法（楼层和电梯数可在代码中设置）

- 20层楼，每层楼有上下两个按钮（底楼的向下和顶楼的向上按钮为禁用状态）
- 5部电梯，每部电梯内部有所有楼层按钮

### 2. 开发和运行

- 使用 `java` 进行开发

- 运行：在根目录下运行命令

  - ```shell
java -jar App.jar
    ```
    
    

## 具体实现

### 1. 电梯运行

- 电梯内部的按钮按下后将对应楼层加入任务楼层

- 电梯类拥有一个状态变量 `state` ，代表电梯运动方向，其有三个取值为 `up` 、 `down` 和 `free` 
- 电梯类还拥有一个布尔变量 `arriveFloor` ，代表电梯是否到达任务楼层，即电梯是否处于停靠状态
- 电梯类中计时器会每隔 **1800ms** 检查一次电梯状态，根据电梯状态执行一下四种不同的指令：
  -  `arriveFloor` 为 `true` ，则将 `arriveFloor` 置为 `false` ，并修改部分数据，执行关门操作
  - 状态为 `up` ，电梯向上一层 
  - 状态为 `down` ，电梯向下一层
  - 状态为 `free` ，执行空操作
- 电梯每向下或向上移动一层后，都会检查该层是否为本电梯的任务楼层，如果是则执行开门操作并修改状态，**修改状态** 的方法如下：
  - 若没有剩余任务，则修改状态为 `free` 
  - 若有剩余任务，且当前状态为 `up` ，判断剩余任务中最高楼层是否大于本楼层，是则继续保持 `up` 状态，否则修改状态为 `down`
  - 若有剩余任务，且当前状态为 `down` ，修改方法与上面相反即可

### 2. 调度算法

- 外部调度中，**基本思想** 为将任务转化为电梯内部任务进行调度
- 为调度准确，在电梯类中添加一个变量 `order` 代表电梯执行的外部指令的方向。即电梯在 `free` 状态接受外部任务时，`order` 取决于外部任务按钮的方向而不是电梯实际运动方向，其他情况下 `order` 与 `state` 相同
- 调度的原则如下：
  - 电梯不响应与其运行方向相反（即 `state` ）的请求。例如上行的电梯不会相应向下的请求
  - 电梯不响应与其在 `free` 状态下已接受的外部指令方向（即 `order` ）相反的请求。即正在响应下降请求的上升电梯不响应上升请求，正在响应上升请求的下降电梯不响应下降请求
  - 上升电梯不响应比电梯当前楼层低的上升请求，下降电梯不响应比电梯当前楼层高的下降请求
  - 在满足上述要求的电梯中寻找 **距离最近** 的电梯，如果距离相同选择非 `free` 状态的电梯
  - 暂时不能被响应的请求加入未处理的请求任务列表中，每隔 **1000ms** 检查清理一次

### 3. 实现细节

- 



## 运行演示



